<html layout:decorate="~{layout}" xmlns:layout="http://www.w3.org/1999/xhtml">

<div class="container" layout:fragment="content">
  <div class="py-5 text-center">
    <h2>질문 목록</h2>
  </div>
    <table class="table table-hover text-center">
      <thead class="table-dark">
        <tr>
          <th scope="col">번호</th>
          <th scope="col">제목</th>
          <th scope="col">글쓴이</th>
          <th scope="col">작성일시</th>
        </tr>
      </thead>
      <tbody>
        <tr th:each="question, index : ${paging}">
<!--          전체 게시물 개수 - (현재 페이지 * 페이지 당 게시물 개수) - 나열 인덱스-->
          <td th:text="${paging.getTotalElements - (paging.number * paging.size) - index.index}">게시물 번호</td>
          <td class="text-start">
            <a th:text="${question.subject}" th:href="@{/question/detail/{id} (id=${question.getId()})}"></a>
            <span class="text-danger small ms-2" th:if="${#lists.size(question.answerList) > 0}" th:text="${#lists.size(question.answerList)}">댓글 수</span>
          </td>
          <td th:text="${question.author != null ? question.author.loginId : 'Unknown'}"></td>
          <td th:text="${#temporals.format(question.creatDate, 'yyyy-MM-dd hh:mm')}"></td>
        </tr>
      </tbody>
    </table>
  <!-- 페이징 처리 시작 -->
  <nav th:if="${!paging.isEmpty()}" aria-label="Page navigation example">
    <ul class="pagination justify-content-center">
      <li th:classappend="${!paging.hasPrevious} ? 'disabled'" class="page-item">
        <a th:href="@{|?page=${paging.number -1}|}" class="page-link" aria-label="Previous">
          <span aria-hidden="true">&laquo;</span>
        </a>
      </li>
      <li th:each="page : ${#numbers.sequence(0, paging.totalPages -1)}" th:if="${page >= paging.number -5 and page <= paging.number+5}" th:classappend="${page == paging.number} ? 'active'" class="page-item" aria-current="page">
        <a th:text="${page}" th:href="@{|?page=${page}|}" class="page-link">1</a>
      </li>
      <li th:classappend="${!paging.hasNext} ? 'disabled'" class="page-item">
        <a th:href="@{|?page=${paging.number +1}|}" class="page-link" aria-label="Next">
          <span aria-hidden="true">&raquo;</span>
        </a>
      </li>
    </ul>
  </nav>
  <!-- 페이징 처리 끝 -->
  <div class="py-2 text-end">
    <button th:onclick="|location.href='@{/question/create}'|" type="button" class="btn btn-dark btn-sm ms-1">질문 등록하기</button>
    <button th:onclick="|location.href='@{/}'|" type="button" class="btn btn-outline-secondary btn-sm ms-1">돌아가기</button>
  </div>
</div>
</html>